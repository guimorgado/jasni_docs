---
title: "Overview"
description: "Enable your AI agents to react instantly to incoming emails"
icon: "/icons-svg/webhook.svg"
---

## What are Webhooks?

Webhooks are the trigger mechanism that awakens your AI agent. Instead of your agent constantly checking for new emails, webhooks notify it instantly when something happens-a new email arrives, a message bounces, or a delivery fails.

<CardGroup cols={2}>
  <Card title="Instant Awareness" icon="/icons-svg/refresh.svg">
    Your agent knows the moment an email arrives
  </Card>
  <Card title="Resource Efficient" icon="/icons-svg/check.svg">
    No wasted cycles polling-agents only wake when needed
  </Card>
  <Card title="Secure" icon="/icons-svg/keys.svg">
    Signed payloads ensure events are authentic
  </Card>
  <Card title="Reliable" icon="/icons-svg/webhook.svg">
    Automatic retries guarantee delivery
  </Card>
</CardGroup>

## Quick Start

### 1. Register a Webhook

<Tabs>
  <Tab title="TypeScript">
```typescript
import { Jasni } from 'jasni-sdk'

const jasni = new Jasni('jsk_your_api_key')

const { webhook } = await jasni.webhooks.create({
  url: 'https://your-server.com/webhooks/jasni',
  events: ['email.received', 'email.sent'],
})

// IMPORTANT: Save the secret - only returned on creation
console.log('Secret:', webhook.secret)
```
  </Tab>
  <Tab title="Python">
```python
from jasni import Jasni

jasni = Jasni("jsk_your_api_key")

result = jasni.webhooks.create(
    url="https://your-server.com/webhooks/jasni",
    events=["email.received", "email.sent"],
)

# IMPORTANT: Save the secret - only returned on creation
print(f"Secret: {result.webhook.secret}")
```
  </Tab>
</Tabs>

<Warning>
  **Save your webhook secret!** The `secret` is only returned when the webhook is created. You'll need it to verify incoming webhook payloads.
</Warning>

### 2. Handle Incoming Webhooks

<Tabs>
  <Tab title="TypeScript (Express)">
```typescript
import { verifySignature } from 'jasni-sdk'

app.post('/webhooks/jasni', express.raw({ type: 'application/json' }), (req, res) => {
  const signature = req.headers['x-jasni-signature'] as string
  const payload = req.body.toString()
  
  if (!verifySignature(payload, signature, process.env.WEBHOOK_SECRET!)) {
    return res.status(401).send('Invalid signature')
  }
  
  const event = JSON.parse(payload)
  
  switch (event.event) {
    case 'email.received':
      console.log('New email from:', event.data.from)
      break
    case 'email.sent':
      console.log('Email sent to:', event.data.to)
      break
  }
  
  res.status(200).send('OK')
})
```
  </Tab>
  <Tab title="Python (FastAPI)">
```python
from fastapi import FastAPI, Request, HTTPException
from jasni.webhooks import verify_signature

app = FastAPI()

@app.post("/webhooks/jasni")
async def handle_webhook(request: Request):
    signature = request.headers.get("X-Jasni-Signature")
    payload = await request.body()
    
    if not verify_signature(payload, signature, WEBHOOK_SECRET):
        raise HTTPException(status_code=401, detail="Invalid signature")
    
    event = await request.json()
    
    match event["event"]:
        case "email.received":
            print(f"New email from: {event['data']['from']}")
        case "email.sent":
            print(f"Email sent to: {event['data']['to']}")
    
    return {"status": "ok"}
```
  </Tab>
</Tabs>

<Tip>
  The `verifySignature()` helper handles timestamp validation and HMAC verification automatically.
</Tip>

## Available Events

| Event | Trigger |
|-------|---------|
| `email.received` | New email arrives in mailbox |
| `email.sent` | Email sent successfully |
| `email.delivered` | Email delivered to recipient's server |
| `email.bounced` | Email delivery failed |
| `email.spam` | Email marked as spam |
| `email.rejected` | Email rejected before delivery |
| `email.deleted` | Email was deleted |
| `domain.verified` | Custom domain verified |

<Card title="Event Reference" icon="/icons-svg/info.svg" href="/webhooks/events">
  See detailed payload schemas for each event
</Card>

## Webhook Payload

Every webhook includes all the context your agent needs to act:

```json
{
  "event": "email.received",
  "timestamp": "2024-01-15T10:30:00.000Z",
  "data": {
    "id": "12345",
    "messageId": "<abc@example.com>",
    "from": "customer@example.com",
    "to": ["agent@yourdomain.com"],
    "subject": "Need help with my order",
    "account": "agent@yourdomain.com",
    "folder": "INBOX",
    "text": "Hi, I have a question about my recent order...",
    "html": "<p>Hi, I have a question about my recent order...</p>"
  }
}
```

## Headers

Each webhook request includes:

| Header | Description |
|--------|-------------|
| `Content-Type` | `application/json` |
| `X-Jasni-Signature` | Signature in format `t=timestamp,v1=signature` |
| `User-Agent` | `JasniAI-Webhooks/1.0` |

## Retry Policy

If your endpoint fails (non-2xx response or timeout), Jasni retries:

| Attempt | Delay |
|---------|-------|
| 1st | Immediate |
| 2nd | 10 seconds |
| 3rd | 60 seconds |
| 4th | 5 minutes |

After 3 failed retries, the delivery is marked as failed.

## Best Practices

<AccordionGroup>
  <Accordion title="Acknowledge fast, process async" icon="/icons-svg/refresh.svg">
    Return a `200` response immediately, then queue the event for your agent to process. Webhooks timeout after 30 seconds.
  </Accordion>
  
  <Accordion title="Design for idempotency" icon="/icons-svg/copy.svg">
    The same event might be delivered multiple times. Your agent should handle duplicates gracefully.
  </Accordion>
  
  <Accordion title="Always verify signatures" icon="/icons-svg/keys.svg">
    Verify the `X-Jasni-Signature` header to ensure events are genuinely from Jasniâ€”not spoofed.
  </Accordion>
  
  <Accordion title="Use HTTPS" icon="/icons-svg/world.svg">
    Always use HTTPS endpoints in production to protect email content in transit.
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={3}>
  <Card title="Events Reference" icon="/icons-svg/info.svg" href="/webhooks/events">
    Detailed payload schemas for each event
  </Card>
  <Card title="Security" icon="/icons-svg/keys.svg" href="/webhooks/security">
    Signature verification deep dive
  </Card>
  <Card title="Best Practices" icon="/icons-svg/check.svg" href="/webhooks/best-practices">
    Production deployment tips
  </Card>
</CardGroup>
