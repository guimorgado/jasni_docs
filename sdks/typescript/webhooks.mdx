---
title: "Webhooks"
description: "Set up real-time notifications with the Jasni TypeScript SDK"
icon: "/icons-svg/webhook.svg"
---

The `webhooks` resource allows you to create, list, update, and delete webhooks for receiving real-time notifications about email events.

## List Webhooks

Retrieve all webhooks:

```typescript
const { webhooks } = await jasni.webhooks.list()

webhooks.forEach(webhook => {
  console.log(`${webhook.url} - Events: ${webhook.events.join(', ')}`)
  console.log(`  Active: ${webhook.active}`)
})
```

### Response

```typescript
interface Webhook {
  id: string
  url: string
  events: WebhookEvent[]
  active: boolean
  description?: string
  created_at: string
  updated_at?: string
}

interface ListWebhooksResponse {
  webhooks: Webhook[]
}
```

## Create Webhook

Create a new webhook:

```typescript
const { webhook } = await jasni.webhooks.create({
  url: 'https://my-server.com/webhook',
  events: ['email.received', 'email.sent'],
  description: 'My webhook',  // Optional
})

// IMPORTANT: Save the secret! It's only returned on creation
console.log('Webhook ID:', webhook.id)
console.log('Webhook Secret:', webhook.secret)
```

<Warning>
  **Save your webhook secret!** The `secret` is only returned when the webhook is created. You'll need it to verify incoming webhook payloads.
</Warning>

### Options

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `url` | `string` | Yes | Webhook URL (must be HTTP or HTTPS) |
| `events` | `WebhookEvent[]` | Yes | Events to subscribe to |
| `description` | `string` | No | Description |

### Available Events

| Event | Description |
|-------|-------------|
| `email.received` | New email received |
| `email.sent` | Email sent |
| `email.delivered` | Email delivered to recipient's server |
| `email.bounced` | Email bounced |
| `email.spam` | Email marked as spam |
| `email.rejected` | Email rejected before delivery |
| `email.deleted` | Email deleted |
| `domain.verified` | Custom domain verified |

### Response

```typescript
interface CreateWebhookResponse {
  webhook: Webhook & { secret: string }
}
```

## Update Webhook

Update an existing webhook:

```typescript
await jasni.webhooks.update({
  id: 'webhook-id',
  url: 'https://new-url.com/webhook',  // Optional
  events: ['email.received'],           // Optional
  active: false,                         // Optional
  description: 'Updated description',    // Optional
})
```

### Options

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | `string` | Yes | Webhook ID |
| `url` | `string` | No | New URL |
| `events` | `WebhookEvent[]` | No | Events to subscribe to |
| `active` | `boolean` | No | Enable/disable webhook |
| `description` | `string` | No | Description |

### Response

```typescript
interface UpdateWebhookResponse {
  webhook: Webhook
}
```

## Delete Webhook

Delete a webhook:

```typescript
await jasni.webhooks.delete('webhook-id')
```

## Example: Webhook Management

Here's a complete example of managing webhooks:

```typescript
import { Jasni } from 'jasni-sdk'

const jasni = new Jasni('jsk_your_api_key')

async function manageWebhooks() {
  // Create a webhook for all email events
  const { webhook } = await jasni.webhooks.create({
    url: 'https://my-server.com/jasni-webhook',
    events: ['email.received', 'email.sent', 'email.bounced'],
    description: 'Production webhook',
  })
  
  console.log('Created webhook:', webhook.id)
  console.log('Secret (save this!):', webhook.secret)
  
  // List all webhooks
  const { webhooks } = await jasni.webhooks.list()
  console.log(`Total webhooks: ${webhooks.length}`)
  
  // Disable a webhook temporarily
  await jasni.webhooks.update({
    id: webhook.id,
    active: false,
  })
  console.log('Webhook disabled')
  
  // Re-enable and update events
  await jasni.webhooks.update({
    id: webhook.id,
    active: true,
    events: ['email.received'],  // Only receive events
  })
  console.log('Webhook enabled with updated events')
  
  // Delete a webhook
  await jasni.webhooks.delete(webhook.id)
  console.log('Webhook deleted')
}

manageWebhooks().catch(console.error)
```

## Verifying Webhook Signatures

The SDK provides helper functions to verify webhook signatures. Jasni uses the format `t=timestamp,v1=signature` in the `X-Jasni-Signature` header:

```typescript
import { verifySignature, constructEvent } from 'jasni-sdk'

// Option 1: Using verifySignature
app.post('/jasni-webhook', express.raw({ type: 'application/json' }), (req, res) => {
  const signature = req.headers['x-jasni-signature'] as string
  const payload = req.body.toString()  // Use raw body, not JSON.stringify
  
  if (!verifySignature(payload, signature, process.env.JASNI_WEBHOOK_SECRET!)) {
    return res.status(401).send('Invalid signature')
  }
  
  // Process the webhook
  const event = JSON.parse(payload)
  console.log('Received event:', event.event)
  
  switch (event.event) {
    case 'email.received':
      console.log('New email from:', event.data.from)
      break
    case 'email.sent':
      console.log('Email sent to:', event.data.to)
      break
    case 'email.bounced':
      console.log('Email bounced:', event.data.bounceReason)
      break
  }
  
  res.status(200).send('OK')
})

// Option 2: Using constructEvent (verifies and parses in one step)
app.post('/jasni-webhook', express.raw({ type: 'application/json' }), (req, res) => {
  try {
    const event = constructEvent(
      req.body,
      req.headers['x-jasni-signature'] as string,
      process.env.JASNI_WEBHOOK_SECRET!
    )
    
    console.log('Received event:', event.event)
    // Handle the event...
    
    res.status(200).send('OK')
  } catch (err) {
    console.error('Invalid webhook:', err.message)
    res.status(401).send('Invalid signature')
  }
})
```

## Webhook Payload Structure

All webhook payloads follow this structure:

```typescript
interface WebhookPayload {
  event: string        // Event type (e.g., 'email.received')
  timestamp: string    // ISO timestamp when event occurred
  data: {
    // Fields vary by event type
    // For email events:
    id?: string        // Email ID
    messageId?: string // RFC 2822 Message-ID
    account?: string   // Email account
    from?: string      // Sender
    to?: string[]      // Recipients
    subject?: string   // Subject
    // Additional fields based on event type
  }
}
```

For more details on webhook payloads and best practices, see the [Webhooks Guide](/webhooks/overview).
